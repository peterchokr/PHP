# 10ì¥: ê²Œì‹œíŒ ì‹œìŠ¤í…œ êµ¬í˜„ (2/3) - ëŒ“ê¸€ ê¸°ëŠ¥

---

---

## âš ï¸ í•„ìˆ˜ ì‚¬ì „ ì¤€ë¹„: ë¡œê·¸ì¸ ì‹œìŠ¤í…œ

**ì´ ì¥ì„ ì§„í–‰í•˜ê¸° ì „ì— ë°˜ë“œì‹œ ì½ìœ¼ì„¸ìš”!**

### ì£¼ì˜ì‚¬í•­

ì´ ì¥ì˜ ëª¨ë“  ì½”ë“œëŠ” **ë¡œê·¸ì¸ ì‹œìŠ¤í…œ**ì„ ê¸°ë°˜ìœ¼ë¡œ í•©ë‹ˆë‹¤.
íŠ¹íˆ `add_comment.php`ë¶€í„°ëŠ” ë‹¤ìŒì´ í•„ìš”í•©ë‹ˆë‹¤:

```
âœ… require 'config.php'     (DB ì—°ê²° + ì„¸ì…˜)
âœ… $_SESSION['user_id']     (ë¡œê·¸ì¸ ì‚¬ìš©ì ID)
âœ… password_verify()        (bcrypt ë¹„ë°€ë²ˆí˜¸ ê²€ì¦)
```

---

## 0ï¸âƒ£ ë¡œê·¸ì¸ ì‹œìŠ¤í…œ êµ¬í˜„ (10ì¥ í•„ìˆ˜ ì „ì œì¡°ê±´)

### âš¡ ë¹ ë¥¸ ì•ˆë‚´

**9ì¥ì„ ì™„ë£Œí–ˆë‹¤ë©´** ê²Œì‹œê¸€ ì‘ì„±/ìˆ˜ì •/ì‚­ì œë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.**10ì¥ì„ ì§„í–‰í•˜ë ¤ë©´** ë‹¤ìŒ 4ê°€ì§€ íŒŒì¼ì´ ë°˜ë“œì‹œ í•„ìš”í•©ë‹ˆë‹¤:

1. **config.php** â­ (ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° + ì„¸ì…˜)
2. **login.php** â­ (ì‚¬ìš©ì ë¡œê·¸ì¸)
3. **logout.php** (ë¡œê·¸ì•„ì›ƒ)
4. **setup_users.php** (í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„± - 1íšŒë§Œ)

---

### 0-1 ê³µí†µ ì„¤ì • íŒŒì¼ (config.php) 

ëª¨ë“  í˜ì´ì§€ì˜ ë§¨ ì²˜ìŒì— ì´ íŒŒì¼ì„ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.

**íŒŒì¼ëª…: `config.php`**

```php
<?php

// config.php - ëª¨ë“  í˜ì´ì§€ì˜ ë§¨ ì²˜ìŒì— í¬í•¨

// ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
$host = 'localhost';
$dbname = 'board_db';
$username = 'root';
$password = '';

try {
    $pdo = new PDO(
        "mysql:host=$host;dbname=$dbname;charset=utf8",
        $username,
        $password
    );
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    die("DB ì—°ê²° ì‹¤íŒ¨: " . $e->getMessage());
}

// ì„¸ì…˜ ì‹œì‘ (ëª¨ë“  í˜ì´ì§€ì—ì„œ $_SESSION ì‚¬ìš© ê°€ëŠ¥)
session_start();

?>
```

---

### 0-2 ë¡œê·¸ì¸ í˜ì´ì§€ (login.php) 

ì‚¬ìš©ìê°€ ë¡œê·¸ì¸í•  ìˆ˜ ìˆëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤.

**íŒŒì¼ëª…: `login.php`**

```php
<?php

// ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° (config.php ì‚¬ìš© ì•ˆ í•¨ - ì„¸ì…˜ ì‹œì‘ ì‹œê°„ì„ ì¡°ì •í•˜ê¸° ìœ„í•¨)
$host = 'localhost';
$dbname = 'board_db';
$username = 'root';
$password = '';

try {
    $pdo = new PDO(
        "mysql:host=$host;dbname=$dbname;charset=utf8",
        $username,
        $password
    );
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
} catch (PDOException $e) {
    die("DB ì—°ê²° ì‹¤íŒ¨: " . $e->getMessage());
}

session_start();

// ì´ë¯¸ ë¡œê·¸ì¸í–ˆìœ¼ë©´ ê²Œì‹œíŒìœ¼ë¡œ ì´ë™
if (isset($_SESSION['user_id'])) {
    header("Location: list.php");
    exit;
}

$error = '';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    try {
        $username_input = htmlspecialchars($_POST['username'] ?? '');
        $password_input = htmlspecialchars($_POST['password'] ?? '');
      
        if (empty($username_input) || empty($password_input)) {
            throw new Exception("ì‚¬ìš©ìëª…ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”");
        }
      
        // ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©ì ì¡°íšŒ
        $sql = "SELECT id, username, password FROM users WHERE username = ?";
        $stmt = $pdo->prepare($sql);
        $stmt->execute([$username_input]);
        $user = $stmt->fetch(PDO::FETCH_ASSOC);
      
        // password_verify(): ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ì™€ bcrypt í•´ì‹œ ë¹„êµ
        if ($user && password_verify($password_input, $user['password'])) {
            $_SESSION['user_id'] = $user['id'];
            $_SESSION['username'] = $user['username'];
            header("Location: list.php");
            exit;
        } else {
            throw new Exception("ì‚¬ìš©ìëª… ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤");
        }
    } catch (Exception $e) {
        $error = $e->getMessage();
    }
}

?>

<!DOCTYPE html>
<html>
<head>
    <title>ë¡œê·¸ì¸ - ê²Œì‹œíŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
      
        body {
            font-family: 'ë§‘ì€ ê³ ë”•', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
      
        .login-container {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
        }
      
        h1 {
            color: navy;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }
      
        .form-group {
            margin-bottom: 20px;
        }
      
        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }
      
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
      
        input:focus {
            outline: none;
            border-color: navy;
            box-shadow: 0 0 5px rgba(0, 0, 139, 0.3);
        }
      
        button {
            width: 100%;
            padding: 12px;
            background-color: navy;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
        }
      
        button:hover {
            background-color: #000080;
        }
      
        .error {
            color: #d32f2f;
            background-color: #ffebee;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #d32f2f;
        }
      
        .test-info {
            background-color: #e8f5e9;
            padding: 12px;
            border-radius: 5px;
            margin-top: 20px;
            border-left: 4px solid #4caf50;
            font-size: 12px;
            color: #333;
        }
      
        .test-info strong {
            display: block;
            margin-bottom: 5px;
            color: #2e7d32;
        }
    </style>
</head>
<body>

<div class="login-container">
    <h1>ğŸ“ ê²Œì‹œíŒ ë¡œê·¸ì¸</h1>
  
    <?php if ($error): ?>
        <div class="error">âŒ <?php echo htmlspecialchars($error); ?></div>
    <?php endif; ?>
  
    <form method="POST">
        <div class="form-group">
            <label for="username">ì‚¬ìš©ìëª…:</label>
            <input type="text" id="username" name="username" placeholder="ì‚¬ìš©ìëª… ì…ë ¥" required autofocus>
        </div>
      
        <div class="form-group">
            <label for="password">ë¹„ë°€ë²ˆí˜¸:</label>
            <input type="password" id="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" required>
        </div>
      
        <button type="submit">ë¡œê·¸ì¸</button>
    </form>
  
    <div class="test-info">
        <strong>ğŸ“ í…ŒìŠ¤íŠ¸ ê³„ì •</strong>
        ì‚¬ìš©ìëª…: user1<br>
        ë¹„ë°€ë²ˆí˜¸: password123<br>
        <br>
        ë˜ëŠ”<br>
        ì‚¬ìš©ìëª…: user2<br>
        ë¹„ë°€ë²ˆí˜¸: password123<br>
        <br>
        <small>ë¹„ë°€ë²ˆí˜¸ëŠ” bcryptë¡œ ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”ë©ë‹ˆë‹¤</small>
    </div>
</div>

</body>
</html>
```

---

### 0-3 ë¡œê·¸ì•„ì›ƒ (logout.php)

**íŒŒì¼ëª…: `logout.php`**

```php
<?php

session_start();

// ì„¸ì…˜ ì‚­ì œ
unset($_SESSION['user_id']);
unset($_SESSION['username']);

// ì„¸ì…˜ ì™„ì „ ì‚­ì œ
session_destroy();

// ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
header("Location: login.php");
exit;

?>
```

---

### 0-4 í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„± (setup_users.php) â­ 1íšŒë§Œ ì‹¤í–‰!

**íŒŒì¼ëª…: `setup_users.php`** (1íšŒë§Œ ì‹¤í–‰)

ë¨¼ì € users í…Œì´ë¸”ì„ ì´ˆê¸°í™”í•˜ì„¸ìš”:

```sql
DELETE FROM users;
```

ê·¸ ë‹¤ìŒ ì´ PHP íŒŒì¼ì„ ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰í•˜ì„¸ìš”.

```php
<?php

$host = 'localhost';
$dbname = 'board_db';
$username = 'root';
$password = '';

try {
    $pdo = new PDO(
        "mysql:host=$host;dbname=$dbname;charset=utf8",
        $username,
        $password
    );
    $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
  
    // í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì ìƒì„±
    $users = array(
        array(
            'username' => 'user1',
            'plain_password' => 'password123',
            'display_name' => 'User1 (ë¹„ë°€ë²ˆí˜¸: password123)'
        ),
        array(
            'username' => 'user2',
            'plain_password' => 'password123',
            'display_name' => 'User2 (ë¹„ë°€ë²ˆí˜¸: password123)'
        ),
        array(
            'username' => 'user3',
            'plain_password' => 'password123',
            'display_name' => 'User3 (ë¹„ë°€ë²ˆí˜¸: password123)'
        )
    );
  
    // ì‚¬ìš©ì ì‚½ì…
    $sql = "INSERT INTO users (username, password) VALUES (?, ?)";
    $stmt = $pdo->prepare($sql);
  
    foreach ($users as $user) {
        // password_hash(): ë¹„ë°€ë²ˆí˜¸ë¥¼ bcryptë¡œ ì•ˆì „í•˜ê²Œ í•´ì‹±
        $hashed = password_hash($user['plain_password'], PASSWORD_BCRYPT);
      
        $stmt->execute(array(
            $user['username'],
            $hashed
        ));
      
        echo "âœ… " . $user['display_name'] . " ì‚¬ìš©ì ìƒì„± ì™„ë£Œ<br>";
    }
  
    echo "<br>âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!<br>";
    echo "<br>ğŸ“ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸:<br>";
    echo "ì‚¬ìš©ìëª…: user1, user2, user3<br>";
    echo "ë¹„ë°€ë²ˆí˜¸: password123 (ëª¨ë‘ ë™ì¼)<br>";
    echo "<br><a href='login.php'>â¡ï¸ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™</a>";
  
} catch (PDOException $e) {
    echo "âŒ ì˜¤ë¥˜: " . $e->getMessage();
}

?>
```

**ì‹¤í–‰ ë°©ë²•:**

1. `setup_users.php` íŒŒì¼ ì €ì¥
2. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost/boards/setup_users.php` ì‹¤í–‰
3. âœ… ì‚¬ìš©ì 3ëª… ìë™ ìƒì„± ì™„ë£Œ
4. ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ (user1 / password123)
5. **ì™„ë£Œ í›„ setup_users.php íŒŒì¼ ì‚­ì œ (ë³´ì•ˆ)**

---

### 0-5 ê²Œì‹œíŒ ì‚¬ìš© ì‹œì‘

**setup_users.php ì‹¤í–‰ í›„:**

1. `http://localhost/boards/login.php` ì ‘ì†
2. user1 / password123 ë¡œê·¸ì¸
3. ê²Œì‹œê¸€ ëª©ë¡ (list.php)ìœ¼ë¡œ ì´ë™
4. ê²Œì‹œê¸€ ì‘ì„±/ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
5. ëŒ“ê¸€ ì‘ì„±/ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥

---

### 0-6 ê¸°ì¡´ 9ì¥ ì½”ë“œ ìˆ˜ì • ì‚¬í•­ (ì„ íƒì‚¬í•­)

9ì¥ì˜ `add.php`, `edit.php`, `delete.php`ë¥¼ ë¡œê·¸ì¸ê³¼ ì—°ë™í•˜ë ¤ë©´:

**ê¸°ì¡´:**

```php
<?php
require 'config.php';

$user_id = 1;  // í…ŒìŠ¤íŠ¸ìš©
```

**ìˆ˜ì •:**

```php
<?php
require 'config.php';

// ë¡œê·¸ì¸ í™•ì¸
if (!isset($_SESSION['user_id'])) {
    header("Location: login.php");
    exit;
}

$user_id = $_SESSION['user_id'];  // ë¡œê·¸ì¸í•œ ì‚¬ìš©ì
```

í•˜ì§€ë§Œ 9ì¥ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šì•„ë„ ì‘ë™í•©ë‹ˆë‹¤. ë‹¤ë§Œ ëª¨ë“  ì‚¬ìš©ìê°€ user_id=1ë¡œ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤.

---

## ğŸ“Œ ì´ ì¥ì—ì„œ ë°°ìš°ëŠ” ê²ƒ

### **ë¬´ì—‡ì„ ë§Œë“œë‚˜ìš”?**

ğŸ‘¥ **ëŒ“ê¸€ ì‹œìŠ¤í…œ** - ì‚¬ëŒë“¤ì´ ê²Œì‹œê¸€ì— ì˜ê²¬ì„ ë‹¬ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥

### **ì™œ í•„ìš”í•œê°€ìš”?**

- ğŸ“ ê²Œì‹œê¸€ì— ëŒ€í•œ í”¼ë“œë°±/ì˜ê²¬ ìˆ˜ì§‘
- ğŸ’¬ ì‚¬ìš©ì ê°„ ìƒí˜¸ì‘ìš© ì¦ì§„
- ğŸ”— ê²Œì‹œê¸€ê³¼ ëŒ“ê¸€ì˜ ê´€ê³„ ê´€ë¦¬

### **ì–´ë–»ê²Œ ë§Œë“œë‚˜ìš”?**

```
1ë‹¨ê³„: ëŒ“ê¸€ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ (comments í…Œì´ë¸”)
2ë‹¨ê³„: ëŒ“ê¸€ ì‘ì„±/ì¡°íšŒ/ìˆ˜ì •/ì‚­ì œ íŒŒì¼ ìƒì„±
3ë‹¨ê³„: ê²Œì‹œê¸€ì— ëŒ“ê¸€ í‘œì‹œ
```

---

## í•™ìŠµëª©í‘œ

ì´ ì¥ì„ í•™ìŠµí•˜ê³  ë‚˜ë©´ ë‹¤ìŒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

âœ… ëŒ“ê¸€ ì‹œìŠ¤í…œì„ ì„¤ê³„í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
âœ… ëŒ“ê¸€ì„ ì‘ì„±(Create), ì¡°íšŒ(Read), ìˆ˜ì •(Update), ì‚­ì œ(Delete)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
âœ… ê²Œì‹œê¸€ì— ë‹¬ë¦° ëŒ“ê¸€ì„ ëª©ë¡ìœ¼ë¡œ í‘œì‹œí•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 1ï¸âƒ£ ëŒ“ê¸€ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### 1-1 ëŒ“ê¸€ ì‹œìŠ¤í…œ ì´í•´

**ëŒ“ê¸€ì´ë€?** ê²Œì‹œê¸€ì— ëŒ€í•œ ì‚¬ìš©ìë“¤ì˜ ì˜ê²¬/ë°˜ì‘ì…ë‹ˆë‹¤.

#### ğŸ“Š í˜„ì‹¤ì˜ ì˜ˆì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê²Œì‹œê¸€ 1ë²ˆ: "PHP ê¸°ì´ˆ ê°•ì¢Œ"         â”‚
â”‚ ì¡°íšŒìˆ˜: 100                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’¬ ëŒ“ê¸€ 1: "ì¢‹ì€ ê¸€ì´ë„¤ìš”!"        â”‚
â”‚    ì‘ì„±ì: ê¹€ì² ìˆ˜ | ë‚ ì§œ: 2024-01-12 â”‚
â”‚                                     â”‚
â”‚ ğŸ’¬ ëŒ“ê¸€ 2: "ë„ì›€ì´ ë˜ì—ˆì–´ìš”"        â”‚
â”‚    ì‘ì„±ì: ì´ì˜í¬ | ë‚ ì§œ: 2024-01-11 â”‚
â”‚                                     â”‚
â”‚ ğŸ’¬ ëŒ“ê¸€ 3: "ê°ì‚¬í•©ë‹ˆë‹¤!"            â”‚
â”‚    ì‘ì„±ì: ë°•ë¯¼ìˆ˜ | ë‚ ì§œ: 2024-01-10 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ğŸ”— ë°ì´í„°ë² ì´ìŠ¤ ê´€ê³„

```
posts í…Œì´ë¸”              comments í…Œì´ë¸”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id: 1            â”‚     â”‚ id: 1                â”‚
â”‚ title: "..."     â”‚1 â†Nâ”€â”‚ post_id: 1          â”‚
â”‚ content: "..."   â”‚     â”‚ user_id: 1          â”‚
â”‚ user_id: 1       â”‚     â”‚ content: "..."      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ created_at: ì‹œê°„    â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚                 â”‚
                      ëŒ“ê¸€ 2            ëŒ“ê¸€ 3
                    (post_id:1)       (post_id:1)

â†’ 1ê°œì˜ ê²Œì‹œê¸€ = Nê°œì˜ ëŒ“ê¸€ (1:N ê´€ê³„)
```

### 1-2 í…Œì´ë¸” ì„¤ê³„

**comments í…Œì´ë¸”** (ëŒ“ê¸€ ì •ë³´)

| ì»¬ëŸ¼ëª…         | íƒ€ì…      | ì„¤ëª…                        |
| -------------- | --------- | --------------------------- |
| `id`         | INT       | ëŒ“ê¸€ ID (ìë™ ì¦ê°€)         |
| `post_id`    | INT       | ì–´ëŠ ê²Œì‹œê¸€ì— ë‹¬ë¦° ëŒ“ê¸€ì¸ì§€ |
| `user_id`    | INT       | ëˆ„ê°€ ì¼ëŠ”ê°€                 |
| `content`    | TEXT      | ëŒ“ê¸€ ë‚´ìš©                   |
| `created_at` | TIMESTAMP | ì‘ì„± ë‚ ì§œ                   |
| `updated_at` | TIMESTAMP | ìˆ˜ì • ë‚ ì§œ                   |

```sql
CREATE TABLE comments (
    id INT AUTO_INCREMENT PRIMARY KEY,
    post_id INT NOT NULL,
    user_id INT NOT NULL,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (post_id) REFERENCES posts(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

**ê° ì»¬ëŸ¼ì˜ ì—­í• **:

```
ê²Œì‹œê¸€ì´ ì‚­ì œë˜ë©´ â†’ ê·¸ ê²Œì‹œê¸€ì˜ ëŒ“ê¸€ë„ ìë™ ì‚­ì œ
user_id í•„ë“œ â†’ "ëˆ„ê°€ ì´ ëŒ“ê¸€ì„ ì¼ëŠ”ê°€" ì¶”ì 
post_id í•„ë“œ â†’ "ì´ ëŒ“ê¸€ì€ ì–´ëŠ ê²Œì‹œê¸€ì— ë‹¬ë ¸ëŠ”ê°€" ì¶”ì 
```

### 1-3 ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±

PHPMyAdminì—ì„œ ë‹¤ìŒ SQLì„ ì‹¤í–‰:

```sql
USE board_db;

-- comments í…Œì´ë¸” ìƒì„±
CREATE TABLE comments (
    id INT AUTO_INCREMENT PRIMARY KEY,
    post_id INT NOT NULL,
    user_id INT NOT NULL,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (post_id) REFERENCES posts(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- ìƒ˜í”Œ ë°ì´í„°
INSERT INTO comments (post_id, user_id, content) VALUES 
(1, 1, 'ì¢‹ì€ ê¸€ì´ë„¤ìš”!'),
(1, 2, 'ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤'),
(2, 1, 'ê³µê°í•©ë‹ˆë‹¤');
```

---

## 2ï¸âƒ£ êµ¬í˜„ ê¸°ëŠ¥

### 2-1 ì „ì²´ íë¦„ ì´í•´

ëŒ“ê¸€ ê¸°ëŠ¥ì˜ 4ê°€ì§€ ì‘ì—…(CRUD):

```
ã€ ëŒ“ê¸€ CRUD íë¦„ ã€‘

C - CREATE (ì‘ì„±)           R - READ (ì¡°íšŒ)
â””â”€ add_comment.php    â”€â†’   â””â”€ view.phpì—ì„œ í‘œì‹œ
   INSERT ì¿¼ë¦¬               SELECT + JOIN ì¿¼ë¦¬

U - UPDATE (ìˆ˜ì •)          D - DELETE (ì‚­ì œ)
â””â”€ edit_comment.php   â†â”€â†’  â””â”€ delete_comment.php
   UPDATE ì¿¼ë¦¬              DELETE ì¿¼ë¦¬
```

**âœ… ë³¸ì¸ ëŒ“ê¸€ë§Œ ìˆ˜ì •/ì‚­ì œ**:

```
WHERE id = ? AND user_id = ?
       â†‘              â†‘
   ëŒ“ê¸€ ID   í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì
   
â†’ ìì‹ ì´ ì“´ ëŒ“ê¸€ë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
```

### 2-2 add_comment.php (ëŒ“ê¸€ ì¶”ê°€)

**ëª©ì **: ì‚¬ìš©ìê°€ ìƒˆë¡œìš´ ëŒ“ê¸€ì„ ì‘ì„±í•˜ëŠ” íŒŒì¼

```php
<?php

require 'config.php';

// ë¡œê·¸ì¸ í™•ì¸
if (!isset($_SESSION['user_id'])) {
    header("Location: login.php");
    exit;
}

$error = '';

if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    try {
        // ì…ë ¥ê°’ ë°›ê¸°
        $post_id = $_POST['post_id'] ?? '';
        // htmlspecialchars()
        // ëª©ì : HTML íŠ¹ìˆ˜ë¬¸ìë¥¼ ì•ˆì „í•œ í˜•íƒœë¡œ ë³€í™˜
        // ì˜ˆ: '<script>' â†’ '<script>' (XSS ê³µê²© ë°©ì§€)
        $content = htmlspecialchars(trim($_POST['content'] ?? ''));
        $user_id = $_SESSION['user_id'];
      
        // ê²€ì¦
        if (empty($post_id) || !is_numeric($post_id)) {
            throw new Exception("ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
        }
      
        if (empty($content)) {
            throw new Exception("ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");
        }
      
        if (strlen($content) > 1000) {
            throw new Exception("ëŒ“ê¸€ì€ 1000ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤");
        }
      
        // ê²Œì‹œê¸€ ì¡´ì¬ í™•ì¸
        // SELECTë¡œ post_idê°€ ì‹¤ì œë¡œ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
        $check_sql = "SELECT id FROM posts WHERE id = ?";
        $check_stmt = $pdo->prepare($check_sql);
        $check_stmt->execute([$post_id]);
      
        if (!$check_stmt->fetch()) {
            throw new Exception("ê²Œì‹œê¸€ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤");
        }
      
        // ëŒ“ê¸€ ì €ì¥
        // INSERT INTO comments
        // ëª©ì : ìƒˆë¡œìš´ ëŒ“ê¸€ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥
        // ë°ì´í„°: post_id(ì–´ëŠ ê²Œì‹œê¸€), user_id(ëˆ„ê°€), content(ë¬´ì—‡)
        $sql = "INSERT INTO comments (post_id, user_id, content) VALUES (?, ?, ?)";
        $stmt = $pdo->prepare($sql);
        $stmt->execute([$post_id, $user_id, $content]);
      
        // ëŒ“ê¸€ ì¶”ê°€ í›„ ì›ë˜ ê²Œì‹œê¸€ë¡œ ì´ë™
        header("Location: view.php?id=$post_id");
        exit;
      
    } catch (Exception $e) {
        $error = $e->getMessage();
    }
}

// ê²Œì‹œê¸€ ID ë°›ê¸°
$post_id = $_GET['post_id'] ?? '';

?>

<!DOCTYPE html>
<html>
<head>
    <title>ëŒ“ê¸€ ì‘ì„±</title>
    <style>
        body { font-family: 'ë§‘ì€ ê³ ë”•'; max-width: 600px; margin: 50px auto; padding: 20px; }
        h1 { color: navy; }
        form { background: #f5f5f5; padding: 15px; }
        textarea { width: 100%; height: 100px; padding: 8px; border: 1px solid #ddd; }
        button { background: navy; color: white; padding: 8px 15px; border: none; cursor: pointer; }
        .error { color: red; padding: 8px; background: #ffe6e6; }
        a { color: navy; text-decoration: none; }
    </style>
</head>
<body>

<h1>ğŸ’¬ ëŒ“ê¸€ ì‘ì„±</h1>

<?php if ($error): ?>
    <div class="error"><?php echo htmlspecialchars($error); ?></div>
<?php endif; ?>

<form method="POST">
    <input type="hidden" name="post_id" value="<?php echo htmlspecialchars($post_id); ?>">
    <textarea name="content" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš” (1000ì ì´ë‚´)" required></textarea><br><br>
    <button type="submit">ëŒ“ê¸€ ë“±ë¡</button>
</form>

<a href="view.php?id=<?php echo htmlspecialchars($post_id); ?>">ëŒì•„ê°€ê¸°</a>

</body>
</html>
```

### 2-3 view.php ìˆ˜ì • (ëŒ“ê¸€ í‘œì‹œ)

ê¸°ì¡´ view.phpì— **ëŒ“ê¸€ ì¡°íšŒ ì„¹ì…˜** ì¶”ê°€:

```php
<?php
// ... ê¸°ì¡´ ê²Œì‹œê¸€ í‘œì‹œ ì½”ë“œ ...

// ëŒ“ê¸€ ì¡°íšŒ
// SELECT ... FROM comments
// ëª©ì : ì´ ê²Œì‹œê¸€ì— ë‹¬ë¦° ëª¨ë“  ëŒ“ê¸€ì„ ì¡°íšŒ
// JOIN users: ëŒ“ê¸€ì„ ì“´ ì‚¬ëŒì˜ ì´ë¦„ë„ í•¨ê»˜ ê°€ì ¸ì˜¤ê¸°
// ORDER BY created_at DESC: ìµœì‹  ëŒ“ê¸€ë¶€í„° í‘œì‹œ
$comments_sql = "
    SELECT c.id, c.content, c.created_at, c.updated_at,
           u.username
    FROM comments c
    JOIN users u ON c.user_id = u.id
    WHERE c.post_id = ?
    ORDER BY c.created_at DESC
";
$comments_stmt = $pdo->prepare($comments_sql);
$comments_stmt->execute([$id]);
$comments = $comments_stmt->fetchAll(PDO::FETCH_ASSOC);

?>

<!-- ê²Œì‹œê¸€ ë‚´ìš© í‘œì‹œ (ê¸°ì¡´ ì½”ë“œ) -->

<!-- ëŒ“ê¸€ ì„¹ì…˜ -->
<hr>
<h2>ğŸ’¬ ëŒ“ê¸€ (<?php echo count($comments); ?>)</h2>

<?php if (empty($comments)): ?>
    <p style="color: #999;">ëŒ“ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
<?php else: ?>
    <?php foreach ($comments as $comment): ?>
        <div style="border: 1px solid #ddd; padding: 10px; margin: 10px 0; background: #f9f9f9;">
            <strong><?php echo htmlspecialchars($comment['username']); ?></strong>
            <span style="color: #999; font-size: 12px;">
                <?php echo $comment['created_at']; ?>
            </span>
            <?php if ($comment['created_at'] !== $comment['updated_at']): ?>
                <span style="color: #f44336; font-size: 12px;">(ìˆ˜ì •ë¨)</span>
            <?php endif; ?>
            <p><?php echo htmlspecialchars($comment['content']); ?></p>
          
            <!-- ë³¸ì¸ì˜ ëŒ“ê¸€ë§Œ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ í‘œì‹œ -->
            <?php if (isset($_SESSION['user_id']) && $_SESSION['user_id'] == $comment['user_id']): ?>
                <a href="edit_comment.php?id=<?php echo $comment['id']; ?>&post_id=<?php echo $id; ?>">ìˆ˜ì •</a>
                <a href="delete_comment.php?id=<?php echo $comment['id']; ?>&post_id=<?php echo $id; ?>" onclick="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');">ì‚­ì œ</a>
            <?php endif; ?>
        </div>
    <?php endforeach; ?>
<?php endif; ?>

<!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
<?php if (isset($_SESSION['user_id'])): ?>
    <a href="add_comment.php?post_id=<?php echo $id; ?>" style="display: inline-block; margin-top: 15px; padding: 8px 15px; background: navy; color: white; text-decoration: none;">ëŒ“ê¸€ ì‘ì„±</a>
<?php else: ?>
    <p style="color: #999; margin-top: 15px;">ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ <a href="login.php">ë¡œê·¸ì¸</a>í•˜ì„¸ìš”.</p>
<?php endif; ?>
```

**ì½”ë“œ ì„¤ëª…**:

```
ã€ ëŒ“ê¸€ í‘œì‹œ ê³¼ì • ã€‘

1. SELECT ì¿¼ë¦¬ë¡œ ëŒ“ê¸€ ì¡°íšŒ
   â†“
2. foreachë¡œ ê° ëŒ“ê¸€ ë°˜ë³µ
   â†“
3. ëŒ“ê¸€ ì‘ì„±ì í™•ì¸ ($_SESSION['user_id'])
   â†“
4. ë³¸ì¸ì´ë©´ "ìˆ˜ì •/ì‚­ì œ" ë²„íŠ¼ í‘œì‹œ
   â†“
5. ë‹¤ë¥¸ ì‚¬ëŒì´ë©´ ë²„íŠ¼ ë¹„í‘œì‹œ
```

### 2-4 edit_comment.php (ëŒ“ê¸€ ìˆ˜ì •)

```php
<?php

require 'config.php';

// ë¡œê·¸ì¸ í™•ì¸
if (!isset($_SESSION['user_id'])) {
    header("Location: login.php");
    exit;
}

$error = '';
$comment = null;
$id = $_GET['id'] ?? null;
$post_id = $_GET['post_id'] ?? null;

if (!$id || !$post_id) {
    die("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤");
}

try {
    // ëŒ“ê¸€ ì¡°íšŒ
    // WHERE id = ? AND user_id = ?
    // ëª©ì : ë³¸ì¸ì˜ ëŒ“ê¸€ë§Œ ìˆ˜ì • ê°€ëŠ¥í•˜ë„ë¡ í™•ì¸
    // ë‹¤ë¥¸ ì‚¬ëŒì˜ ëŒ“ê¸€ì€ ì¡°íšŒ ê²°ê³¼ê°€ ì—†ìœ¼ë¯€ë¡œ ìˆ˜ì • ë¶ˆê°€ëŠ¥
    $sql = "SELECT id, content FROM comments WHERE id = ? AND user_id = ?";
    $stmt = $pdo->prepare($sql);
    $stmt->execute([$id, $_SESSION['user_id']]);
  
    $comment = $stmt->fetch(PDO::FETCH_ASSOC);
  
    if (!$comment) {
        die("ëŒ“ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤");
    }
  
} catch (PDOException $e) {
    die("ì¡°íšŒ ì‹¤íŒ¨: " . $e->getMessage());
}

// POST ìš”ì²­ ì²˜ë¦¬ (ìˆ˜ì •)
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    try {
        $content = htmlspecialchars(trim($_POST['content'] ?? ''));
      
        if (empty($content)) {
            throw new Exception("ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”");
        }
      
        if (strlen($content) > 1000) {
            throw new Exception("ëŒ“ê¸€ì€ 1000ì ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤");
        }
      
        // UPDATE ì¿¼ë¦¬
        // ëª©ì : ëŒ“ê¸€ ë‚´ìš© ì—…ë°ì´íŠ¸
        // updated_atì€ ìë™ìœ¼ë¡œ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë¨
        $sql = "UPDATE comments SET content = ? WHERE id = ? AND user_id = ?";
        $stmt = $pdo->prepare($sql);
        $stmt->execute([$content, $id, $_SESSION['user_id']]);
      
        header("Location: view.php?id=$post_id");
        exit;
      
    } catch (Exception $e) {
        $error = $e->getMessage();
    }
}

?>

<!DOCTYPE html>
<html>
<head>
    <title>ëŒ“ê¸€ ìˆ˜ì •</title>
    <style>
        body { font-family: 'ë§‘ì€ ê³ ë”•'; max-width: 600px; margin: 50px auto; padding: 20px; }
        h1 { color: navy; }
        form { background: #f5f5f5; padding: 15px; }
        textarea { width: 100%; height: 100px; padding: 8px; border: 1px solid #ddd; }
        button { background: navy; color: white; padding: 8px 15px; border: none; cursor: pointer; }
        .error { color: red; padding: 8px; background: #ffe6e6; }
        a { color: navy; text-decoration: none; }
    </style>
</head>
<body>

<h1>âœï¸ ëŒ“ê¸€ ìˆ˜ì •</h1>

<?php if ($error): ?>
    <div class="error"><?php echo htmlspecialchars($error); ?></div>
<?php endif; ?>

<form method="POST">
    <textarea name="content" required><?php echo htmlspecialchars($comment['content']); ?></textarea><br><br>
    <button type="submit">ìˆ˜ì •í•˜ê¸°</button>
</form>

<a href="view.php?id=<?php echo htmlspecialchars($post_id); ?>">ëŒì•„ê°€ê¸°</a>

</body>
</html>
```

### 2-5 delete_comment.php (ëŒ“ê¸€ ì‚­ì œ)

```php
<?php

require 'config.php';

// ë¡œê·¸ì¸ í™•ì¸
if (!isset($_SESSION['user_id'])) {
    header("Location: login.php");
    exit;
}

try {
    $id = $_GET['id'] ?? null;
    $post_id = $_GET['post_id'] ?? null;
  
    if (!$id || !$post_id) {
        throw new Exception("ì˜ëª»ëœ ìš”ì²­ì…ë‹ˆë‹¤");
    }
  
    // DELETE ì¿¼ë¦¬
    // WHERE id = ? AND user_id = ?
    // ëª©ì : ë³¸ì¸ì˜ ëŒ“ê¸€ë§Œ ì‚­ì œ ê°€ëŠ¥
    // ë‹¤ë¥¸ ì‚¬ëŒì˜ ëŒ“ê¸€ì„ ì‚­ì œí•˜ë ¤ê³  í•˜ë©´ ì•„ë¬´ê²ƒë„ ì‚­ì œë˜ì§€ ì•ŠìŒ
    $sql = "DELETE FROM comments WHERE id = ? AND user_id = ?";
    $stmt = $pdo->prepare($sql);
    $stmt->execute([$id, $_SESSION['user_id']]);
  
    header("Location: view.php?id=$post_id");
    exit;
  
} catch (Exception $e) {
    die("ì‚­ì œ ì‹¤íŒ¨: " . htmlspecialchars($e->getMessage()));
}

?>
```

---

## 3ï¸âƒ£ ê³¼ì œ

### í•„ìˆ˜ ê³¼ì œ

```
1. ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
   - board_dbì— comments í…Œì´ë¸” ìƒì„±
   - ìƒ˜í”Œ ë°ì´í„° 3ê°œ ì´ìƒ ì¶”ê°€

2. ëŒ“ê¸€ ê¸°ëŠ¥ êµ¬í˜„
   - add_comment.php êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸
   - view.phpì— ëŒ“ê¸€ í‘œì‹œ ê¸°ëŠ¥ ì¶”ê°€
   - ëŒ“ê¸€ì´ ìµœì‹ ìˆœìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

3. ëŒ“ê¸€ ìˆ˜ì •/ì‚­ì œ
   - edit_comment.php êµ¬í˜„
   - delete_comment.php êµ¬í˜„
   - ë³¸ì¸ì˜ ëŒ“ê¸€ë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥í•œì§€ í™•ì¸
```

### ì„ íƒ ê³¼ì œ

```
1. ëŒ“ê¸€ ì‘ì„±ì ì´ë¦„ ì˜†ì— "ì‘ì„±ì" ë˜ëŠ” "ê´€ë¦¬ì" ë°°ì§€ ì¶”ê°€ (12ì¥ ë¯¸ë¦¬ë³´ê¸°)
2. ëŒ“ê¸€ ìˆ˜ë¥¼ ê²Œì‹œê¸€ ëª©ë¡(list.php)ì—ë„ í‘œì‹œ
3. ëŒ“ê¸€ ê¸¸ì´ ì œí•œì„ 1000ìì—ì„œ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ë³€ê²½
```

---

## 4ï¸âƒ£ í•µì‹¬ ê°œë…

### JOINì„ ì´ìš©í•œ ë‹¤ì¤‘ í…Œì´ë¸” ì¡°íšŒ

**ë¬¸ì œ**: ëŒ“ê¸€ ì •ë³´ë§Œìœ¼ë¡œëŠ” ì‘ì„±ì ì´ë¦„ì„ ëª¨ë¦„

```
comments í…Œì´ë¸”
â”‚ id: 1, post_id: 1, user_id: 1, content: "ì¢‹ì•„ìš”" â”‚
                                  â†‘
                              ìˆ«ìì¼ ë¿

ì´ë¦„ì´ ë­”ì§€ ì•Œë ¤ë©´?
â†’ users í…Œì´ë¸”ì—ì„œ user_id = 1ì¸ ì‚¬ëŒ ì°¾ì•„ì•¼ í•¨
```

**í•´ê²°ì±…**: JOIN ì‚¬ìš©

```php
// ëŒ“ê¸€ê³¼ ì‘ì„±ì ì •ë³´ë¥¼ í•¨ê»˜ ì¡°íšŒ
SELECT c.id, c.content, c.created_at,
       u.username              â† users í…Œì´ë¸”ì˜ ì´ë¦„
FROM comments c
JOIN users u ON c.user_id = u.id   â† ë‘ í…Œì´ë¸” ì—°ê²°
WHERE c.post_id = ?
```

**ì‹œê°í™”**:

```
comments í…Œì´ë¸”              users í…Œì´ë¸”
â”‚ id: 1                   â”‚ id: 1
â”‚ user_id: 1     â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ username: "ê¹€ì² ìˆ˜"
â”‚ content: "..."           â”‚ email: "kim@example.com"


JOIN ê²°ê³¼:
â”‚ id: 1 (ëŒ“ê¸€ ID)
â”‚ user_id: 1
â”‚ content: "ì¢‹ì•„ìš”"
â”‚ username: "ê¹€ì² ìˆ˜" â† JOINìœ¼ë¡œ ê°€ì ¸ì˜´
```

### FOREIGN KEY ì œì•½

```sql
FOREIGN KEY (post_id) REFERENCES posts(id) ON DELETE CASCADE
```

**ì˜ë¯¸**:

- ê²Œì‹œê¸€ì´ ì‚­ì œë˜ë©´ â†’ ê·¸ ê²Œì‹œê¸€ì˜ ëŒ“ê¸€ë„ ìë™ ì‚­ì œ
- ë°ì´í„° ì¼ê´€ì„± ìœ ì§€ (ê³ ì•„ ë°ì´í„° ë°©ì§€)

```
ê²Œì‹œê¸€ ì‚­ì œ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DELETE FROM postsâ”‚
â”‚ WHERE id = 1     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
ìë™ìœ¼ë¡œ ë°œìƒ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DELETE FROM comments           â”‚
â”‚ WHERE post_id = 1              â”‚ â† CASCADE
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë³¸ì¸ í™•ì¸ (ë³´ì•ˆ)

```php
WHERE id = ? AND user_id = ?
```

**ì‘ë™ ë°©ì‹**:

```
ã€ ëŒ“ê¸€ ìˆ˜ì • ì‹œë‚˜ë¦¬ì˜¤ ã€‘

1ï¸âƒ£ ì‚¬ìš©ì Aê°€ ìì‹ ì˜ ëŒ“ê¸€(id=5) ìˆ˜ì •
   UPDATE comments SET content = "..." 
   WHERE id = 5 AND user_id = 1    â† ë³¸ì¸ ID
   
   â†’ ì„±ê³µ! (ë°ì´í„° ë³€ê²½ë¨)

2ï¸âƒ£ ì‚¬ìš©ì Bê°€ ì‚¬ìš©ì Aì˜ ëŒ“ê¸€(id=5) ìˆ˜ì • ì‹œë„
   UPDATE comments SET content = "..." 
   WHERE id = 5 AND user_id = 2    â† ë‹¤ë¥¸ ì‚¬ëŒ ID
   
   â†’ ì‹¤íŒ¨! (WHERE ì¡°ê±´ ë¶ˆì¼ì¹˜ë¡œ ì•„ë¬´ê²ƒë„ ë³€ê²½ ì•ˆ ë¨)
```

---

## 5ï¸âƒ£ ì£¼ì˜ì‚¬í•­

1. **ëŒ“ê¸€ ì‘ì„±ì í™•ì¸**: ë³¸ì¸ì˜ ëŒ“ê¸€ë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥í•˜ë„ë¡ WHEREì— user_id í•„ìˆ˜
2. **ì…ë ¥ê°’ ê²€ì¦**: htmlspecialchars()ë¡œ XSS ë°©ì§€
3. **íŠ¸ëœì­ì…˜**: ê²Œì‹œê¸€ ì‚­ì œ ì‹œ ëŒ“ê¸€ë„ í•¨ê»˜ ì‚­ì œ (CASCADE ì‚¬ìš©)
4. **ì˜¤ë¥˜ ì²˜ë¦¬**: try-catchë¡œ ë°ì´í„°ë² ì´ìŠ¤ ì—ëŸ¬ ì²˜ë¦¬

---

ìˆ˜ê³ í–ˆìŠµë‹ˆë‹¤.

ì¡°ì •í˜„ êµìˆ˜(peterchokr@gmail.com)
ì˜ë‚¨ì´ê³µëŒ€í•™êµ
